# Maintainer: Your Name <your.email@example.com>
pkgname=engraver-bin
pkgver=0.1.0
pkgrel=1
pkgdesc="Safe, fast tool for creating bootable USB drives"
arch=('x86_64' 'aarch64')
url="https://github.com/mstephenholl/engraver"
license=('MIT')
provides=('engraver')
conflicts=('engraver' 'engraver-git')
depends=('gcc-libs')
optdepends=(
    'bash-completion: for bash completion'
    'zsh-completions: for zsh completion'
    'fish: for fish completion'
)

source_x86_64=("${url}/releases/download/v${pkgver}/engraver-v${pkgver}-x86_64-unknown-linux-gnu.tar.gz")
source_aarch64=("${url}/releases/download/v${pkgver}/engraver-v${pkgver}-aarch64-unknown-linux-gnu.tar.gz")

sha256sums_x86_64=('PLACEHOLDER_SHA256_X64')
sha256sums_aarch64=('PLACEHOLDER_SHA256_ARM64')

package() {
    cd "${srcdir}/engraver-v${pkgver}-${CARCH}-unknown-linux-gnu"
    
    # Install binary
    install -Dm755 engraver "${pkgdir}/usr/bin/engraver"
    
    # Install shell completions
    install -Dm644 completions/engraver.bash "${pkgdir}/usr/share/bash-completion/completions/engraver"
    install -Dm644 completions/_engraver "${pkgdir}/usr/share/zsh/site-functions/_engraver"
    install -Dm644 completions/engraver.fish "${pkgdir}/usr/share/fish/vendor_completions.d/engraver.fish"
    
    # Install man pages
    install -Dm644 man/engraver.1 "${pkgdir}/usr/share/man/man1/engraver.1"
    install -Dm644 man/engraver-write.1 "${pkgdir}/usr/share/man/man1/engraver-write.1"
    install -Dm644 man/engraver-verify.1 "${pkgdir}/usr/share/man/man1/engraver-verify.1"
    install -Dm644 man/engraver-list.1 "${pkgdir}/usr/share/man/man1/engraver-list.1"
    install -Dm644 man/engraver-checksum.1 "${pkgdir}/usr/share/man/man1/engraver-checksum.1"
    
    # Install license
    install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE" 2>/dev/null || true
}
